<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="new-test-suite.xml" />
	<munit:test name="new-test-suite-order-api-mainTest" doc:id="72fec7ce-51cb-4e23-b8bf-50d184a2d43a" description="Test" ignore="true">
		<munit:execution >
			<flow-ref doc:name="Flow-ref to order-api-main" doc:id="352df3c6-14f5-4ffd-990e-96ad71c19c6a" name="order-api-main"/>
		</munit:execution>
	</munit:test>
	<munit:test name="new-test-suite-order-api-consoleTest" doc:id="0766c91b-ef88-4f09-bb6a-8ea80a857549" description="Test" ignore="true">
		<munit:execution >
			<flow-ref doc:name="Flow-ref to order-api-console" doc:id="1b0104a2-8159-4e2f-b424-ae9ffec9f282" name="order-api-console"/>
		</munit:execution>
	</munit:test>
	<munit:test name="new-test-suite-put:\OrderAcknowledgement:application\json:order-api-configTest" doc:id="320c6aa9-89c2-4f18-a68f-7f12ce964eea" description="Test" ignore="true">
		<munit:execution >
			<flow-ref doc:name="Flow-ref to put:\OrderAcknowledgement:application\json:order-api-config" doc:id="5e25c81a-93f0-4e62-9391-f24ee6307612" name="put:\OrderAcknowledgement:application\json:order-api-config"/>
		</munit:execution>
	</munit:test>
	<munit:test name="new-test-suite-put:\(orderId):application\json:order-api-configTest" doc:id="d75d4cd7-58ca-4f3e-afc0-d92c67b3fb65" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Order Update Request" doc:id="562ec9b8-8055-457c-a9f4-c329927aa9a0" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="90092d68-159a-47d8-8d29-9babb6bf5c33" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#['order update request']" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock OAuth Flow" doc:id="d8e6beda-7812-4f24-8ebb-8362c7e20af5" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="23c7a3e6-8d0d-4265-baff-d93deda2cf47" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/oauthtoken.dwl")]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:spy doc:name="Spy" doc:id="3a5079bb-29d0-4385-ad0f-e2442b362733" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="23c7a3e6-8d0d-4265-baff-d93deda2cf47" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:before-call >
					<logger level="INFO" doc:name="Logger" doc:id="20eb02c9-3400-4e56-b2b5-d64769659ef3" message="payload before call #[payload]"/>
				</munit-tools:before-call>
				<munit-tools:after-call >
					<logger level="INFO" doc:name="Logger" doc:id="7c07a576-850c-4315-af52-10b94edf5281" message="payload before call #[payload]"/>
				</munit-tools:after-call>
			</munit-tools:spy>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to put:\(orderId):application\json:order-api-config" doc:id="f73a6de6-e76a-4444-a7a7-944f10a9e8d3" name="put:\(orderId):application\json:order-api-config"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:assert doc:name="Assert expression" doc:id="88df4ed0-c7ea-406e-bb32-aa977f3d64dc" />
		</munit:validation>
	</munit:test>
	<munit:test name="getOrderCountGreaterThanZeroTest" doc:id="cb33cf56-8d10-47e9-a92c-e46616b7b0d7">
		<munit:behavior >
			<munit-tools:mock-when doc:name="GetBearerToken" doc:id="d15f4d2b-be63-401e-9e01-4bc6411f41ec" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="5eed7bd0-d11e-4df4-90f7-a52aa347e672" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/oauthtoken.dwl")]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetAccessToken" doc:id="7db41109-2aa3-44a9-88bd-afe9d03a827a" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="5eed7bd0-d11e-4df4-90f7-a52aa347e672" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/oauthtoken.dwl")]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetSFCCOrderIDs" doc:id="ce36c840-9fb8-46e6-8115-825bff7afe95" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d4c56769-144e-40e0-9270-d1624f3f9006" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/getsfccorderids.dwl")]' mediaType="application/java" />
				</munit-tools:then-return>
				
				
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetOrderDetails" doc:id="96521c99-c132-4ba8-afc0-6e3a57745e27" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="6fb0a336-880a-4f0c-bb25-6bdc5595649f" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/getorderdetails.dwl")]' mediaType="application/java" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to get:\orders:order-api-config" doc:id="a7e39886-6f3e-403f-9d49-1fcfaaf0c20b" name="get:\orders:order-api-config"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="a75619ab-c43e-4a8a-8ef7-6c146d7309d9" />
		</munit:validation>
	</munit:test>
	
	<munit:test name="access-token-settings-subflowTest" doc:id="cd8d4ef7-2bd2-40d7-802d-e1cf0510b4a0" description="Test">
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="b670d3fa-5e13-455b-aad9-55e3e63695e8" >
				<munit:payload value='[
  {
    "Order": {
      "clientID": "abmI1YUPl2kXvnEzZ16CPNgpGu",
      "company_code": "",
      "country_Code": "US",
      "brandID": "LE",
      "creationDateTime": "2019-10-18T16:23:44.000Z",
      "changeDateTime": "2019-10-18T16:23:44.000Z",
      "alternateOrderID": "00000101",
      "customerOrderID": "00000101",
      "giftOrderInd": "N",
      "Orderamount": 3161.50,
      "currencyCode": "USD",
      "OrderItemamount": 2969.96,
      "discountAmount": "148.50",
      "OrdersalesTaxAmount": 150.55,
      "adjustments": {
        "adustmentAmount": 148.50
      },
      "shipping_adress": {
        "Shipmentamount": [
          40.99
        ],
        "adr1": [
          "4775 Ogeechee Dr"
        ],
        "city": [
          "Johns Creek"
        ],
        "country": [
          "US"
        ],
        "zip": [
          "30022"
        ],
        "ShipmemntsalesTaxAmount": [
          2.05
        ]
      },
      "paymentInfo": {
        "payMethodName": [
          "Visa"
        ],
        "billingContact": {
          "givenName": "Brian",
          "familyName": "Tarbell",
          "address": {
            "addressLine1": "4775 Ogeechee Dr",
            "cityName": "Johns Creek",
            "stateProvinceCode": "GA",
            "postalCode": "30022"
          }
        },
        "payMethodCode": "MC",
        "payMethodType": "PP"
      },
      "orderLine": [
        {
          "lineID": "3c9801bef24dffc978f296eaa5",
          "partNumber": "640188017003M",
          "retailAmount": 899.97,
          "sellingAmount": 719.97,
          "discountAmount": -180.00,
          "shippingamount": 25.00,
          "salesTaxAmount": 45.00
        },
        {
          "lineID": "b4f2eebadd8273b6a0457ed75b",
          "partNumber": "mitsubishi-wd-73736M",
          "retailAmount": 2249.99,
          "sellingAmount": 2249.99,
          "discountAmount": null,
          "shippingamount": 15.99,
          "salesTaxAmount": 112.50
        }
      ]
    }
  }
]' mediaType="application/json" />
				<munit:variables >
					<munit:variable key="accessToken" value="payload.access_token" mediaType="application/json" />
					<munit:variable key="HeaderVar" value="' ' ++ 'Bearer' ++ ' ' ++ vars.accessToken" />
				</munit:variables>
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to access-token-settings-subflow" doc:id="3fab34ff-12ec-4aee-ad35-21700006ebef" name="access-token-settings-subflow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="ffd91619-80ab-48e6-ae64-06326e3f027f" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
vars.HeaderVar must notBeNull()]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:assert doc:name="Copy_of_Assert expression" doc:id="7ef372a0-fd26-452b-85db-fc5c7c7078f4" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
vars.accessToken must notBeNull()]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
	<munit:test name="bearer-token-settings-Sub_FlowTest" doc:id="8b0d1dcf-2668-45c0-adf5-ce63f86dbe90" description="Test">
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="69deda10-3281-48fb-a39e-9cde3f9d1193" >
				<munit:variables >
					<munit:variable key="bearerToken" value="payload.access_token" mediaType="application/json" />
					<munit:variable key="headerData" value="' ' ++ 'Bearer' ++ ' ' ++ vars.bearerToken" mediaType="application/json" />
				</munit:variables>
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to bearer-token-settings-Sub_Flow" doc:id="e9fc8901-8bbc-4228-8c13-0999e1cf0849" name="bearer-token-settings-Sub_Flow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="1e066aee-d5eb-449f-87c0-518873280cb5" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
vars.headerData must notBeNull()]]]></munit-tools:that>
			</munit-tools:assert>
			<munit-tools:assert doc:name="Copy_of_Assert expression" doc:id="ea6f8ac9-66a5-45c4-b74a-61f7af05712b" >
				<munit-tools:that ><![CDATA[#[import * from dw::test::Asserts 
 ---
vars.bearerToken must notBeNull()]]]></munit-tools:that>
			</munit-tools:assert>
		</munit:validation>
	</munit:test>
<munit:test name="OrderIdFlowTest" doc:id="aab7cb44-df82-4fe5-9bdd-e726f9ea3a07" description="Test">
		<munit:behavior >
			<munit-tools:mock-when doc:name="GetOrderDetails" doc:id="8e92a993-e414-4241-9a59-24841b858d8a" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="5ebe2179-104f-48b9-a9ce-261b9eaf5f00" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/getorderdetails.dwl")]' mediaType="application/java" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Flow-ref to OrderIdFlow" doc:id="31053aed-3437-4b5c-9a47-adb480d69b76" name="OrderIdFlow"/>
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="d459d8f1-69de-4a1c-843f-532ec1b5e641" />
		</munit:validation>
	</munit:test>
	<munit:test name="GetOrderCountLessThanOrEqualZeroTest" doc:id="1f9b37e9-103a-49f7-8c91-a3ad8927e7f0" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="GetBearerToken" doc:id="34f488e0-a445-4a71-98f7-a8ce442b0d1f" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="1173d1d8-20c8-427f-9276-4b8cd9ad23fa" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/oauthtoken.dwl")]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetAccessToken" doc:id="63b45f1a-b8bb-4fbe-8e72-dd644bf16d9d" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="5eed7bd0-d11e-4df4-90f7-a52aa347e672" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/oauthtoken.dwl")]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetSFCCOrderIDs" doc:id="36f9b18c-2991-4c43-8530-2e431e16aa94" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d4c56769-144e-40e0-9270-d1624f3f9006" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/getsfccorderids_Zero.dwl")]' mediaType="application/java" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="GetOrderDetails" doc:id="5a52db27-c8e2-4bb4-b459-8ca5f45d56ea" processor="flow-ref">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="6fb0a336-880a-4f0c-bb25-6bdc5595649f" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#[readUrl("classpath://testData/getorderdetails.dwl")]' mediaType="application/java" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<flow-ref doc:name="Copy_of_Flow-ref to get:\orders:order-api-config" doc:id="42706f5c-eec8-4a53-b5b7-36bb2c0c3d18" name="get:\orders:order-api-config" />
		</munit:execution>
		<munit:validation >
			<munit-tools:assert doc:name="Assert expression" doc:id="a03c9acb-57c8-4b7e-8aa6-7e5836fb647b" />
		</munit:validation>
	</munit:test>

</mule>
